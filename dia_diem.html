<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý HomeStay</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/homstay.css">
    <link rel="stylesheet" href="css/dia_diem.css">
</head>
<body>
    <header class="header">
        <div style="display: flex; align-items: center; gap: 1rem;">
            <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="header-title">Trang Quản Trị</div>
        </div>
        <div style="display: flex; align-items: center; gap: 1rem;">
            <div class="admin-profile">
                <div class="admin-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <span>Admin</span>
            </div>
            <div class="admin-profile">
                <div class="admin-avatar">
                    <a class="home" href="giaoDienNguoiDung/index.html">
                        <i class="fas fa-home"></i>
                    </a>
                </div>
                <a class="home" href="giaoDienNguoiDung/index.html"><span>Trang chủ</span></a>
            </div>
        </div>
    </header>

    <nav class="sidebar">
        <a href="index.html" class="nav-item "><i class="fas fa-home"></i><span>Bảng điều khiển</span></a>
        <a href="danhmuc.html" class="nav-item"><i class="fas fa-list"></i><span>Danh mục</span></a>
        <a href="bai_viet.html" class="nav-item"><i class="fas fa-file-alt"></i><span>Bài viết</span></a>
        <a href="dia_diem.html" class="nav-item active"><i class="fas fa-map-marker-alt"></i><span>Địa điểm</span></a>
        <a href="homestay.html" class="nav-item "><i class="fas fa-hotel"></i><span>Nhà nghỉ</span></a>
        <a href="rooms.html" class="nav-item"><i class="fas fa-bed"></i><span>Danh sách phòng</span></a>
        <a href="danhSachDatPhong.html" class="nav-item"><i class="fas fa-calendar-alt"></i><span>Danh sách đặt phòng</span></a>
        <a href="comment.html" class="nav-item"><i class="fas fa-comments"></i><span>Quản lý bình luận</span></a>
        <a href="role.html" class="nav-item"><i class="fas fa-user-cog"></i><span>Vai trò</span></a>
        <a href="nguoiDung.html" class="nav-item"><i class="fas fa-users"></i><span>Người dùng</span></a>
    </nav>

    <main class="main-content">
        <div class="breadcrumb">
            <span>Trang quản trị</span><span>/</span>
            <span id="bai-viet-link" style="cursor: pointer; color: #4A5568;">Bài viết</span><span>/</span>
            <span id="breadcrumb-danh-sach" style="color: #A0AEC0;">Danh sách</span>
        </div>
        <h1 style="font-weight: bold; text-align: center;">ĐỊA ĐIỂM</h1>
        <!-- Thêm thanh tìm kiếm -->
        <div class="search-bar">
            <input type="text" placeholder="Tên địa điểm..." class="search-input" id="searchInput">
            <button class="search-button" onclick="searchPosts()"><i class="fas fa-search"></i> Tìm kiếm</button>
        </div>

        <div class="table-container">
            <div class="action-btn-top">
                <button class="action-btn" onclick="addPost()"><i class="fas fa-plus"></i> Tạo mới</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th style="text-align: left;">STT</th>
                        <th style="text-align: left;">Tên địa điểm</th>
                        <th>Hình ảnh</th>
                        <th>Trạng thái</th>
                        <th>Hành động</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dữ liệu sẽ được chèn ở đây từ file JSON -->
                </tbody>
            </table>
        </div>
        <div class="container1" style="display: none;">
            <!-- Phần bên trái: Chỉnh sửa bài viết -->
            <div class="left-section">
                <div class="edit-section">
        
                    <div class="form-group">
                        <label for="title">Tiêu đề bài viết <span>*</span></label>
                        <input type="text" id="title" placeholder="Thêm cơ sở mới gần khu vui chơi">
                    </div>
        
                    <div class="form-group">
                        <label for="category">Danh mục <span>*</span></label>
                        <select id="category">
                            <option>Tin tức</option>
                            <option>Du lịch</option>
                            <option>Kinh nghiệm</option>
                            <option>Khám phá</option>
                            <!-- Thêm các danh mục khác tại đây -->
                        </select>
                    </div>
        
                    <div class="form-group">
                        <label for="status">Trạng thái</label>
                        <select id="status">
                            <option>Hoạt động</option>
                            <option>Đang bảo trì</option>
                        </select>
                    </div>
        
                    <div class="form-group">
                        <label for="short-description">Mô tả ngắn</label>
                        <div id="short-description" class="editor">
                            <div class="toolbar">
                                <button onclick="applyBold()"><i class="fa fa-bold"></i></button>
                                <button onclick="applyItalic()"><i class="fa fa-italic"></i></button>
                                <button onclick="applyUnderline()"><i class="fa fa-underline"></i></button>
                                <button onclick="applyStrikeThrough()"><i class="fa fa-strikethrough"></i></button>
                                <button onclick="alignLeft()"><i class="fa fa-align-left"></i></button>
                                <button onclick="alignCenter()"><i class="fa fa-align-center"></i></button>
                                <button onclick="alignRight()"><i class="fa fa-align-right"></i></button>
                                <button onclick="insertUnorderedList()"><i class="fa fa-list-ul"></i></button>
                                <button onclick="insertOrderedList()"><i class="fa fa-list-ol"></i></button>
                                <button onclick="insertLink()"><i class="fa fa-link"></i></button>
                                <button onclick="insertImage()"><i class="fa fa-image"></i></button>
                                <button onclick="insertTable()"><i class="fa fa-table"></i></button>
                                <button onclick="changeFont()"><i class="fa fa-font"></i></button>
                                <button onclick="changeTextSize()"><i class="fa fa-text-height"></i></button>
                                <button onclick="changeTextColor()"><i class="fa fa-paint-brush"></i></button>
                                <button onclick="insertEmoji()"><i class="fa fa-smile"></i></button>
                                
                            </div>
                            <div contenteditable="true" id="short-description-textarea" class="editable-textarea" placeholder="Giá rẻ dành cho sinh viên"></div>
                        </div>
                    </div>
                </div>
            </div>
        
            <!-- Phần bên phải: Xuất bản và Hình ảnh -->
            <div class="right-section">
                <div class="form-actions">
                    <h3>Xuất bản</h3>
                    <button class="btn-save" onclick="savePostEdit()">Lưu dữ liệu</button>
                    <button class="btn-reset">Reset</button>
                </div>
        
                <div class="image-upload-section">
                    <label for="image-url">URL Hình ảnh:</label>
                    <input type="text" id="image-url" placeholder="Nhập URL hình ảnh" />
                    <div class="image-preview-container">
                        <img id="image-preview" src="" alt="Preview" style="display:none; width: 100%; height: auto;" />
                    </div>
                </div>                                                        
            </div>
        </div>
    </main>

    <script>
        // Mobile menu toggle
        const menuToggle = document.querySelector('.menu-toggle');
        const sidebar = document.querySelector('.sidebar');

        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });

        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 768) {
                if (!sidebar.contains(e.target) && !menuToggle.contains(e.target)) {
                    sidebar.classList.remove('active');
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
    loadPostsDiaDiem(); // Gọi hàm để tải dữ liệu từ JSON sau khi trang đã tải xong
});

async function loadPostsDiaDiem() {
    try {
        const response = await fetch('data/dia_diem.json');
        
        // Kiểm tra xem phản hồi có hợp lệ không (status 200)
        if (!response.ok) {
            throw new Error('Không thể tải dữ liệu từ file JSON: ' + response.statusText);
        }
        
        const posts = await response.json();
        const tableBody = document.querySelector('.table-container tbody');
        tableBody.innerHTML = ''; // Xóa dữ liệu cũ trước khi thêm dữ liệu mới

        if (posts.length === 0) {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td colspan="5" style="text-align: center;">Không có địa điểm nào để hiển thị</td>
            `;
            tableBody.appendChild(row);
        } else {
            posts.forEach((post, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${post.tenDiaDiem}</td>
                    <td><img src="${post.hinhAnh}" id='fullImage' alt="Image" width="100" height="100"></td>
                    <td>${post.trangThai}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="edit-button" onclick="editPost(${post.id})"><i class="fas fa-edit"></i></button>
                            <button class="delete-button" onclick="deletePost(${post.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
    } catch (error) {
        console.error('Lỗi khi tải dữ liệu bài viết:', error);
        
        // Thông báo lỗi trong bảng
        const tableBody = document.querySelector('.table-container tbody');
        tableBody.innerHTML = `<tr><td colspan="5" style="text-align: center; color: red;">Có lỗi xảy ra khi tải dữ liệu. Vui lòng thử lại sau.</td></tr>`;
    }
}

function editPost(postId) {
    alert(`Chỉnh sửa địa điểm với ID: ${postId}`);
    // Thực hiện xử lý chỉnh sửa bài viết tại đây
}

function deletePost(postId) {
    const isConfirmed = confirm(`Bạn có chắc chắn muốn xóa địa điểm có ID: ${postId}?`);
    if (isConfirmed) {
        alert(`Xóa địa điểm với ID: ${postId}`);
        // Thực hiện xử lý xóa bài viết tại đây
    }
}
    </script>
</body>
</html>